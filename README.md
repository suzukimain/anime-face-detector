# Anime Face Detector
[![PyPI version](https://badge.fury.io/py/anime-face-detector.svg)](https://pypi.org/project/anime-face-detector/)
[![Downloads](https://pepy.tech/badge/anime-face-detector)](https://pepy.tech/project/anime-face-detector)
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/hysts/anime-face-detector/blob/main/demo.ipynb)
[![Hugging Face Spaces](https://img.shields.io/badge/%F0%9F%A4%97%20Hugging%20Face-Spaces-orange)](https://huggingface.co/spaces/hysts/anime-face-detector)
[![MIT License](https://img.shields.io/badge/license-MIT-green)](https://opensource.org/licenses/MIT)
[![GitHub stars](https://img.shields.io/github/stars/hysts/anime-face-detector.svg?style=flat-square&logo=github&label=Stars&logoColor=white)](https://github.com/hysts/anime-face-detector)

This is an anime face detector now powered by [Ultralytics YOLO](https://github.com/ultralytics/ultralytics).

**✨ New in v0.1.0: Windows compatible! No more OpenMMLab build issues!**

![](https://raw.githubusercontent.com/hysts/anime-face-detector/main/assets/output.jpg)
(To avoid copyright issues, the above demo uses images generated by the
[TADNE](https://thisanimedoesnotexist.ai/) model.)

The model detects near-frontal anime faces and predicts 28 landmark points.
![](https://raw.githubusercontent.com/hysts/anime-face-detector/main/assets/landmarks.jpg)

## What's Changed in v0.1.0

- ✅ **Windows Support**: Works on Windows without compilation issues
- ✅ **Modern Dependencies**: Uses Ultralytics YOLO instead of old OpenMMLab
- ✅ **Easy Installation**: Simple `pip install` with pre-built wheels
- ✅ **Faster Setup**: No need for `mmcv-full`, `mmdet`, or `mmpose`
- ✅ **Compatible API**: Same interface as v0.0.9 for easy migration

### Migration from v0.0.9

If you were using v0.0.9 (OpenMMLab-based), the API remains the same:

```python
# Your existing code still works!
from anime_face_detector import create_detector
detector = create_detector('yolov3')  # Maps to yolov8n
detector = create_detector('faster-rcnn')  # Maps to yolov8s
```

## Installation

### Simple Installation (Recommended)

```bash
pip install anime-face-detector
```

That's it! Works on **Windows, Linux, and macOS**.

### Development Installation

```bash
git clone https://github.com/hysts/anime-face-detector
cd anime-face-detector
pip install -e .
```

## System Requirements

- Python 3.8+
- Windows 10/11, Linux, or macOS
- (Optional) CUDA for GPU acceleration

## Usage
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/hysts/anime-face-detector/blob/main/demo.ipynb)

```python
import cv2
from anime_face_detector import create_detector

# Create detector (auto-downloads model on first run)
detector = create_detector('yolov8n')  # or 'yolov8s', 'yolov8m'

# Load image
image = cv2.imread('assets/input.jpg')

# Detect faces and landmarks
preds = detector(image)

# Results
print(preds[0])
```

### Model Options

- `yolov8n`: Fastest, good for real-time (recommended)
- `yolov8s`: Balanced speed/accuracy
- `yolov8m`: More accurate, slower
- `yolov8l`, `yolov8x`: Highest accuracy

For backward compatibility:
- `'yolov3'` → maps to `yolov8n`
- `'faster-rcnn'` → maps to `yolov8s`
```

### Output Format

```python
{'bbox': array([x0, y0, x1, y1, score], dtype=float32),
 'keypoints': array([[x, y, confidence], ...], dtype=float32)}  # 28 points
```

## Demo (using [Gradio](https://github.com/gradio-app/gradio))
[![Hugging Face Spaces](https://img.shields.io/badge/%F0%9F%A4%97%20Hugging%20Face-Spaces-orange)](https://huggingface.co/spaces/hysts/anime-face-detector)

### Run locally
```bash
pip install gradio
python demo_gradio.py
```

Options:
```bash
python demo_gradio.py --detector yolov8n --device cpu
python demo_gradio.py --detector yolov8m --device cuda:0  # More accurate
```

## Troubleshooting

### Windows Issues
If you encounter issues on Windows:
1. Make sure you have Python 3.8+ (64-bit)
2. Update pip: `python -m pip install --upgrade pip`
3. Install PyTorch first: `pip install torch torchvision --index-url https://download.pytorch.org/whl/cu118`
4. Then install this package: `pip install anime-face-detector`

### CUDA Issues
If CUDA is not detected:
```python
detector = create_detector('yolov8n', device='cpu')  # Force CPU
```

## Performance

| Model | Speed (CPU) | Speed (GPU) | Accuracy |
|-------|-------------|-------------|----------|
| yolov8n | ~50ms | ~5ms | Good |
| yolov8s | ~80ms | ~8ms | Better |
| yolov8m | ~150ms | ~12ms | Best |

*Tested on Intel i7-12700K (CPU) and RTX 3080 (GPU)*

## Citation
If you find this repo useful for your research, please consider citing it:
```bibtex
@misc{anime-face-detector,
  author = {hysts},
  title = {Anime Face Detector},
  year = {2021},
  howpublished = {\url{https://github.com/hysts/anime-face-detector}}
}
```

## Links
### General
- https://github.com/open-mmlab/mmdetection
- https://github.com/open-mmlab/mmpose

### Anime face detection
- https://github.com/zymk9/yolov5_anime [![Hugging Face Spaces](https://img.shields.io/badge/%F0%9F%A4%97%20Hugging%20Face-Spaces-orange)](https://huggingface.co/spaces/hysts/yolov5_anime)
- https://github.com/qhgz2013/anime-face-detector
- https://github.com/cheese-roll/light-anime-face-detector
- https://github.com/nagadomi/lbpcascade_animeface [![Hugging Face Spaces](https://img.shields.io/badge/%F0%9F%A4%97%20Hugging%20Face-Spaces-orange)](https://huggingface.co/spaces/hysts/lbpcascade_animeface)

### Anime face landmark detection
- https://github.com/kanosawa/anime_face_landmark_detection [![Hugging Face Spaces](https://img.shields.io/badge/%F0%9F%A4%97%20Hugging%20Face-Spaces-orange)](https://huggingface.co/spaces/hysts/anime_face_landmark_detection)

### Others
- https://www.gwern.net/Faces
- https://thisanimedoesnotexist.ai
